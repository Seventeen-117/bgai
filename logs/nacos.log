2025-05-19 13:20:13.027 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-05-19 13:20:13.029 [main] INFO  com.bgpay.bgai.BgaiApplication - The following 1 profile is active: "dev"
2025-05-19 13:20:14.958 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:20:14.959 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-19 13:20:14.995 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 25 ms. Found 0 JPA repository interfaces.
2025-05-19 13:20:15.012 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:20:15.014 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-19 13:20:15.032 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-05-19 13:20:15.742 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:20:15.752 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:20:15.760 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Initializing Global Transaction Clients ... 
2025-05-19 13:20:15.894 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:20:15.895 [main] INFO  io.seata.discovery.registry.RegistryFactory - use registry center type: file
2025-05-19 13:20:15.906 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:20:15.911 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:TMROLE,address:8.133.246.113:8091,msg:< RegisterTMRequest{version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='ak=null
digest=bgai-tx-group,192.168.86.8,1747632015909
timestamp=1747632015909
authVersion=V4
vgroup=bgai-tx-group
ip=192.168.86.8
'} >
2025-05-19 13:20:16.278 [main] INFO  io.seata.core.rpc.netty.TmNettyRemotingClient - register TM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0x7b076161, L:/192.168.86.8:59200 - R:/8.133.246.113:8091]
2025-05-19 13:20:16.288 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 213 ms, version:1.8.1-SNAPSHOT,role:TMROLE,channel:[id: 0x7b076161, L:/192.168.86.8:59200 - R:/8.133.246.113:8091]
2025-05-19 13:20:16.289 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:20:16.307 [main] INFO  io.seata.rm.datasource.AsyncWorker - Async Commit Buffer Limit: 10000
2025-05-19 13:20:16.308 [main] INFO  io.seata.rm.datasource.xa.ResourceManagerXA - ResourceManagerXA init ...
2025-05-19 13:20:16.322 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:20:16.322 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:20:16.322 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Global Transaction Clients are initialized. 
2025-05-19 13:20:17.879 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-19 13:20:17.893 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - The ["http-nio-8080"] connector has been configured to support HTTP upgrade to [h2c]
2025-05-19 13:20:17.893 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-19 13:20:17.896 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-05-19 13:20:17.896 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.15]
2025-05-19 13:20:18.465 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-05-19 13:20:18.742 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:20:18.742 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - RM will register :jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:20:18.742 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:RMROLE,address:8.133.246.113:8091,msg:< RegisterRMRequest{resourceIds='jdbc:mysql://8.133.246.113:3306/deepseek', version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='null'} >
2025-05-19 13:20:18.767 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - register RM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0x9d3b05c8, L:/192.168.86.8:59214 - R:/8.133.246.113:8091]
2025-05-19 13:20:18.767 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 16 ms, version:1.8.1-SNAPSHOT,role:RMROLE,channel:[id: 0x9d3b05c8, L:/192.168.86.8:59214 - R:/8.133.246.113:8091]
2025-05-19 13:20:18.770 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'masterDataSource' by 'AT' mode.
2025-05-19 13:20:18.846 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} inited
2025-05-19 13:20:18.923 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:20:18.924 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'slaveDataSource' by 'AT' mode.
2025-05-19 13:20:18.932 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:20:18.947 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:20:18.947 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'dynamicDataSource' by 'AT' mode.
2025-05-19 13:20:18.963 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:20:19.099 [main] INFO  org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-05-19 13:20:19.180 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.1.7.Final
2025-05-19 13:20:19.581 [main] INFO  SQL dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL8Dialect
2025-05-19 13:20:19.583 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-05-19 13:20:19.958 [main] INFO  o.h.e.t.jta.platform.internal.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-05-19 13:20:19.973 [main] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:20:20.592 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:20:20.612 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:20:20.657 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:20:20.660 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:20:20.661 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:20:20.679 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:20:21.495 [main] INFO  com.bgpay.bgai.service.impl.UserServiceImpl - 初始化SSO配置: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:20:21.636 [main] INFO  com.bgpay.bgai.controller.AuthController - 初始化认证控制器: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:20:22.446 [main] INFO  o.a.r.s.autoconfigure.RocketMQAutoConfiguration - a producer (billing-producer-group) init on namesrv 8.133.246.113:9876
2025-05-19 13:20:23.034 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:20:23.035 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:20:23.047 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 加载到1个Saga状态机定义文件
2025-05-19 13:20:23.298 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 开始解析状态机定义: bgai-saga-transaction
2025-05-19 13:20:23.299 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 状态机定义解析成功: bgai-saga-transaction
2025-05-19 13:20:23.299 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 成功加载状态机定义: /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:20:23.942 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-05-19 13:20:24.113 [redisson-netty-4-6] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:20:24.574 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:20:24.873 [main] INFO  com.bgpay.bgai.service.mq.MQConsumerService - MQ consumer startup successful [group=billing-consumer-group, topic=BILLING_TOPIC, tag=USER_BILLING]
2025-05-19 13:20:25.231 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Bean [com.bgpay.bgai.service.SeataTransactionService$$SpringCGLIB$$0] with name [seataTransactionService] would use interceptor [io.seata.spring.annotation.GlobalTransactionalInterceptor]
2025-05-19 13:20:25.364 [main] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Initializing ExecutorService 'blockingExecutor'
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [After]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Before]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Between]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Cookie]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Header]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Host]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Method]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Path]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Query]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [ReadBody]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [RemoteAddr]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [XForwardedRemoteAddr]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Weight]
2025-05-19 13:20:26.798 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [CloudFoundryRouteService]
2025-05-19 13:20:28.168 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-05-19 13:20:28.631 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:20:28.631 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:20:28.658 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Initializing Global Transaction Clients ... 
2025-05-19 13:20:28.658 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:20:28.658 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:20:28.659 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:bgtech-ai#bgai-tx-group
2025-05-19 13:20:28.659 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Global Transaction Clients are initialized. 
2025-05-19 13:20:28.676 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:20:30.202 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-19 13:20:30.223 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-19 13:20:30.234 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ans.namespace attribute : null
2025-05-19 13:20:30.234 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ALIBABA_ALIWARE_NAMESPACE attribute :null
2025-05-19 13:20:30.235 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from namespace attribute :null
2025-05-19 13:20:30.246 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-05-19 13:20:30.246 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-05-19 13:20:30.250 [main] INFO  com.alibaba.nacos.common.remote.client - [RpcClientFactory] create a new rpc client of ec952600-515e-4d5f-afa6-54002273d17e
2025-05-19 13:20:30.252 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] RpcClient init, ServerListFactory = com.alibaba.nacos.client.naming.core.ServerListManager
2025-05-19 13:20:30.252 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Registry connection listener to current client:com.alibaba.nacos.client.naming.remote.gprc.redo.NamingGrpcRedoService
2025-05-19 13:20:30.252 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Register server push request handler:com.alibaba.nacos.client.naming.remote.gprc.NamingPushRequestHandler
2025-05-19 13:20:30.253 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Try to connect to server on start up, server: {serverIp = '8.133.246.113', server main port = 8848}
2025-05-19 13:20:30.253 [main] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - grpc client connection server:8.133.246.113 ip,serverPort:9848,grpcTslConfig:{"sslProvider":"OPENSSL","enableTls":false,"mutualAuthEnable":false,"trustAll":false}
2025-05-19 13:20:30.383 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Success to connect to server [8.133.246.113:8848] on start up, connectionId = 1747632030269_139.227.195.203_43957
2025-05-19 13:20:30.383 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Notify connected event to listeners.
2025-05-19 13:20:30.383 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$ConnectResetRequestHandler
2025-05-19 13:20:30.383 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.client.naming - Grpc connection connect
2025-05-19 13:20:30.383 [main] INFO  com.alibaba.nacos.common.remote.client - [ec952600-515e-4d5f-afa6-54002273d17e] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$$Lambda/0x0000020135532900
2025-05-19 13:20:30.385 [main] INFO  com.alibaba.nacos.client.naming - [REGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 registering service bgtech-ai with instance Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={IPv6=[2408:820c:7528:8342:b486:9b72:4b72:4bf0], preserved.register.source=SPRING_CLOUD}}
2025-05-19 13:20:30.416 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP bgtech-ai 192.168.86.8:8080 register finished
2025-05-19 13:20:30.483 [main] INFO  com.bgpay.bgai.BgaiApplication - Started BgaiApplication in 20.327 seconds (process running for 22.837)
2025-05-19 13:20:30.487 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:20:30.488 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:20:30.500 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:20:30.501 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:20:30.501 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:20:30.511 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:20:30.511 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:20:30.511 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:20:30.519 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:20:30.519 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:20:30.520 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:20:30.526 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:20:30.526 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - ==================== Saga状态机加载报告 ====================
2025-05-19 13:20:30.526 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga状态机配置加载状态: 成功
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件数量: 1
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件:
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig -  - /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga解析器状态: CUSTOM_FASTJSON2
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 状态机解析结果: 成功 1 个, 失败 0 个
2025-05-19 13:20:30.527 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - =============================================================
2025-05-19 13:20:30.531 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - nacos.cache.data.init.snapshot = true 
2025-05-19 13:20:30.531 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] common-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:20:30.539 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=common-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:20:30.539 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=common-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:20:30.539 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:20:30.540 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:20:30.540 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai.yaml, group=DEFAULT_GROUP
2025-05-19 13:20:30.541 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:20:30.541 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:20:30.541 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:20:30.541 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:20:30.542 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:20:30.542 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai, group=DEFAULT_GROUP
2025-05-19 13:20:36.685 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.filter.ApiKeyAuthenticationFilter - Skipping API Key validation for excluded path: /auth/authorize
2025-05-19 13:20:36.705 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.MockAuthController - Authorization request: client_id=bgai-client-id, redirect_uri=http://localhost:8080/api/auth/callback, response_type=code
2025-05-19 13:20:48.217 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.filter.ApiKeyAuthenticationFilter - Skipping API Key validation for excluded path: /api/auth/callback
2025-05-19 13:20:48.308 [http-nio-8080-exec-4] DEBUG com.bgpay.bgai.filter.ApiKeyAuthenticationFilter - Skipping API Key validation for excluded path: /auth/token
2025-05-19 13:20:48.318 [http-nio-8080-exec-4] INFO  com.bgpay.bgai.controller.MockAuthController - Token request: grant_type=null, code=null, client_id=null
2025-05-19 13:20:48.383 [http-nio-8080-exec-6] DEBUG com.bgpay.bgai.filter.ApiKeyAuthenticationFilter - Skipping API Key validation for excluded path: /auth/userinfo
2025-05-19 13:20:48.395 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.findByUserId - ==>  Preparing: SELECT * FROM t_user WHERE user_id = ?
2025-05-19 13:20:48.397 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.findByUserId - ==> Parameters: 689258T(String)
2025-05-19 13:20:48.436 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.findByUserId - <==      Total: 1
2025-05-19 13:20:48.690 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.updateById - ==>  Preparing: UPDATE t_user SET user_id=?, username=?, email=?, avatar_url=?, last_login_time=?, access_token=?, refresh_token=?, token_expire_time=?, status=?, create_time=?, update_time=? WHERE id=?
2025-05-19 13:20:48.701 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.updateById - ==> Parameters: 689258T(String), 测试用户(String), test@example.com(String), https://ui-avatars.com/api/?name=测试用户(String), 2025-05-19T13:20:48.437144800(LocalDateTime), 1361d019-fde9-46db-b05d-2254356f1a42(String), 149913d0-cefe-4b0d-8f14-c33fda0b6e07(String), 2025-05-19T14:20:48.437144800(LocalDateTime), 1(Integer), 2025-04-26T23:59:16(LocalDateTime), 2025-05-19T13:20:48.437144800(LocalDateTime), 1(Long)
2025-05-19 13:20:48.742 [http-nio-8080-exec-3] DEBUG com.bgpay.bgai.mapper.UserMapper.updateById - <==    Updates: 1
2025-05-19 13:23:38.935 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-05-19 13:23:38.935 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-05-19 13:23:38.936 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-05-19 13:23:38.937 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-05-19 13:23:38.968 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.968 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.968 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.968 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.968 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:23:38.969 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x7b076161, L:/192.168.86.8:59200 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:23:38.969 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x9d3b05c8, L:/192.168.86.8:59214 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:23:38.983 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-05-19 13:23:38.987 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - [DEREGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 deregistering service bgtech-ai with instance: Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
2025-05-19 13:23:39.017 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-05-19 13:23:39.020 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown begin
2025-05-19 13:23:39.020 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown stop
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown begin
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown begin
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown stop
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown begin
2025-05-19 13:23:39.021 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:23:39.021 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown stop
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown begin
2025-05-19 13:23:39.021 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:23:39.021 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown stop
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown rpc client, set status to shutdown
2025-05-19 13:23:39.021 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown client event executor java.util.concurrent.ScheduledThreadPoolExecutor@4c77eb54[Running, pool size = 2, active threads = 2, queued tasks = 0, completed tasks = 0]
2025-05-19 13:23:39.022 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Close current connection 1747632030269_139.227.195.203_43957
2025-05-19 13:23:39.031 [nacos-grpc-client-executor-8.133.246.113-52] WARN  c.a.nacos.common.remote.client.grpc.GrpcClient - [1747632030269_139.227.195.203_43957]Ignore error event,isRunning:false,isAbandon=false
2025-05-19 13:23:39.032 [SpringContextShutdownHook] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - Shutdown grpc executor java.util.concurrent.ThreadPoolExecutor@6716eb44[Running, pool size = 5, active threads = 0, queued tasks = 0, completed tasks = 53]
2025-05-19 13:23:39.032 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - Shutdown grpc redo service executor java.util.concurrent.ScheduledThreadPoolExecutor@7d1a7bd8[Running, pool size = 1, active threads = 0, queued tasks = 1, completed tasks = 62]
2025-05-19 13:23:39.032 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - [null] CredentialWatcher is stopped
2025-05-19 13:23:39.032 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialService - [null] CredentialService is freed
2025-05-19 13:23:39.033 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown stop
2025-05-19 13:23:41.081 [SpringContextShutdownHook] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Shutting down ExecutorService 'blockingExecutor'
2025-05-19 13:23:41.131 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:23:41.131 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:23:41.152 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:23:41.152 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:23:41.268 [SpringContextShutdownHook] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:23:41.269 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closing ...
2025-05-19 13:23:41.276 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closed
2025-05-19 13:23:41.276 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-05-19 13:23:41.277 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-05-19 13:33:55.631 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-05-19 13:33:55.633 [main] INFO  com.bgpay.bgai.BgaiApplication - The following 1 profile is active: "dev"
2025-05-19 13:33:57.461 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:33:57.463 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-19 13:33:57.486 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 JPA repository interfaces.
2025-05-19 13:33:57.498 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:33:57.499 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-19 13:33:57.515 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-05-19 13:33:58.069 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:33:58.077 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:33:58.083 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Initializing Global Transaction Clients ... 
2025-05-19 13:33:58.184 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:33:58.185 [main] INFO  io.seata.discovery.registry.RegistryFactory - use registry center type: file
2025-05-19 13:33:58.195 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:33:58.199 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:TMROLE,address:8.133.246.113:8091,msg:< RegisterTMRequest{version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='ak=null
digest=bgai-tx-group,192.168.86.8,1747632838198
timestamp=1747632838198
authVersion=V4
vgroup=bgai-tx-group
ip=192.168.86.8
'} >
2025-05-19 13:33:58.330 [main] INFO  io.seata.core.rpc.netty.TmNettyRemotingClient - register TM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0xfc74db87, L:/192.168.86.8:59406 - R:/8.133.246.113:8091]
2025-05-19 13:33:58.336 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 68 ms, version:1.8.1-SNAPSHOT,role:TMROLE,channel:[id: 0xfc74db87, L:/192.168.86.8:59406 - R:/8.133.246.113:8091]
2025-05-19 13:33:58.337 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:33:58.350 [main] INFO  io.seata.rm.datasource.AsyncWorker - Async Commit Buffer Limit: 10000
2025-05-19 13:33:58.351 [main] INFO  io.seata.rm.datasource.xa.ResourceManagerXA - ResourceManagerXA init ...
2025-05-19 13:33:58.358 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:33:58.358 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:33:58.358 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Global Transaction Clients are initialized. 
2025-05-19 13:33:59.471 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-19 13:33:59.480 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - The ["http-nio-8080"] connector has been configured to support HTTP upgrade to [h2c]
2025-05-19 13:33:59.481 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-19 13:33:59.482 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-05-19 13:33:59.482 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.15]
2025-05-19 13:33:59.901 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-05-19 13:34:00.153 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:34:00.153 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - RM will register :jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:34:00.153 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:RMROLE,address:8.133.246.113:8091,msg:< RegisterRMRequest{resourceIds='jdbc:mysql://8.133.246.113:3306/deepseek', version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='null'} >
2025-05-19 13:34:00.170 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - register RM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0x4050435c, L:/192.168.86.8:59410 - R:/8.133.246.113:8091]
2025-05-19 13:34:00.171 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 11 ms, version:1.8.1-SNAPSHOT,role:RMROLE,channel:[id: 0x4050435c, L:/192.168.86.8:59410 - R:/8.133.246.113:8091]
2025-05-19 13:34:00.172 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'masterDataSource' by 'AT' mode.
2025-05-19 13:34:00.244 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} inited
2025-05-19 13:34:00.313 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:34:00.314 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'slaveDataSource' by 'AT' mode.
2025-05-19 13:34:00.322 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:34:00.338 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:34:00.338 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'dynamicDataSource' by 'AT' mode.
2025-05-19 13:34:00.350 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:34:00.462 [main] INFO  org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-05-19 13:34:00.517 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.1.7.Final
2025-05-19 13:34:00.850 [main] INFO  SQL dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL8Dialect
2025-05-19 13:34:00.852 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-05-19 13:34:01.199 [main] INFO  o.h.e.t.jta.platform.internal.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-05-19 13:34:01.214 [main] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:34:01.606 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:34:01.617 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:34:01.646 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:34:01.648 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:34:01.648 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:34:01.659 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:34:02.297 [main] INFO  com.bgpay.bgai.service.impl.UserServiceImpl - 初始化SSO配置: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:34:02.439 [main] INFO  com.bgpay.bgai.controller.AuthController - 初始化认证控制器: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:34:03.003 [main] INFO  o.a.r.s.autoconfigure.RocketMQAutoConfiguration - a producer (billing-producer-group) init on namesrv 8.133.246.113:9876
2025-05-19 13:34:03.261 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Bean [com.bgpay.bgai.service.deepseek.DeepSeekServiceImp$$SpringCGLIB$$0] with name [deepSeekServiceImp] would use interceptor [io.seata.spring.annotation.GlobalTransactionalInterceptor]
2025-05-19 13:34:03.539 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:34:03.540 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:34:03.552 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 加载到1个Saga状态机定义文件
2025-05-19 13:34:03.726 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 开始解析状态机定义: bgai-saga-transaction
2025-05-19 13:34:03.726 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 状态机定义解析成功: bgai-saga-transaction
2025-05-19 13:34:03.726 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 成功加载状态机定义: /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:34:04.224 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-05-19 13:34:04.355 [redisson-netty-4-6] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:34:04.673 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:34:04.930 [main] INFO  com.bgpay.bgai.service.mq.MQConsumerService - MQ consumer startup successful [group=billing-consumer-group, topic=BILLING_TOPIC, tag=USER_BILLING]
2025-05-19 13:34:05.225 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Bean [com.bgpay.bgai.service.SeataTransactionService$$SpringCGLIB$$0] with name [seataTransactionService] would use interceptor [io.seata.spring.annotation.GlobalTransactionalInterceptor]
2025-05-19 13:34:05.350 [main] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Initializing ExecutorService 'blockingExecutor'
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [After]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Before]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Between]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Cookie]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Header]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Host]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Method]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Path]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Query]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [ReadBody]
2025-05-19 13:34:06.635 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [RemoteAddr]
2025-05-19 13:34:06.636 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [XForwardedRemoteAddr]
2025-05-19 13:34:06.636 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Weight]
2025-05-19 13:34:06.636 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [CloudFoundryRouteService]
2025-05-19 13:34:08.037 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-05-19 13:34:08.356 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:34:08.357 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:34:08.370 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Initializing Global Transaction Clients ... 
2025-05-19 13:34:08.371 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:34:08.371 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:34:08.371 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:bgtech-ai#bgai-tx-group
2025-05-19 13:34:08.371 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Global Transaction Clients are initialized. 
2025-05-19 13:34:08.379 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:34:09.680 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-19 13:34:09.694 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-19 13:34:09.704 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ans.namespace attribute : null
2025-05-19 13:34:09.704 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ALIBABA_ALIWARE_NAMESPACE attribute :null
2025-05-19 13:34:09.705 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from namespace attribute :null
2025-05-19 13:34:09.714 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-05-19 13:34:09.714 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-05-19 13:34:09.718 [main] INFO  com.alibaba.nacos.common.remote.client - [RpcClientFactory] create a new rpc client of f0b62547-e3b4-458c-8686-c237d94c64ce
2025-05-19 13:34:09.720 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] RpcClient init, ServerListFactory = com.alibaba.nacos.client.naming.core.ServerListManager
2025-05-19 13:34:09.720 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Registry connection listener to current client:com.alibaba.nacos.client.naming.remote.gprc.redo.NamingGrpcRedoService
2025-05-19 13:34:09.720 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Register server push request handler:com.alibaba.nacos.client.naming.remote.gprc.NamingPushRequestHandler
2025-05-19 13:34:09.720 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Try to connect to server on start up, server: {serverIp = '8.133.246.113', server main port = 8848}
2025-05-19 13:34:09.720 [main] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - grpc client connection server:8.133.246.113 ip,serverPort:9848,grpcTslConfig:{"sslProvider":"OPENSSL","enableTls":false,"mutualAuthEnable":false,"trustAll":false}
2025-05-19 13:34:09.848 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Success to connect to server [8.133.246.113:8848] on start up, connectionId = 1747632849737_139.227.195.203_43256
2025-05-19 13:34:09.848 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$ConnectResetRequestHandler
2025-05-19 13:34:09.848 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Notify connected event to listeners.
2025-05-19 13:34:09.848 [main] INFO  com.alibaba.nacos.common.remote.client - [f0b62547-e3b4-458c-8686-c237d94c64ce] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$$Lambda/0x00000165875262d8
2025-05-19 13:34:09.848 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.client.naming - Grpc connection connect
2025-05-19 13:34:09.849 [main] INFO  com.alibaba.nacos.client.naming - [REGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 registering service bgtech-ai with instance Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={IPv6=[2408:820c:7528:8342:b486:9b72:4b72:4bf0], preserved.register.source=SPRING_CLOUD}}
2025-05-19 13:34:09.867 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP bgtech-ai 192.168.86.8:8080 register finished
2025-05-19 13:34:09.921 [main] INFO  com.bgpay.bgai.BgaiApplication - Started BgaiApplication in 16.677 seconds (process running for 18.18)
2025-05-19 13:34:09.925 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:34:09.926 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:34:09.938 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:34:09.938 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:34:09.939 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:34:09.949 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:34:09.949 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:34:09.950 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:34:09.958 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:34:09.959 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:34:09.959 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:34:09.975 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - ==================== Saga状态机加载报告 ====================
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga状态机配置加载状态: 成功
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件数量: 1
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件:
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig -  - /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga解析器状态: CUSTOM_FASTJSON2
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 状态机解析结果: 成功 1 个, 失败 0 个
2025-05-19 13:34:09.976 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - =============================================================
2025-05-19 13:34:09.981 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - nacos.cache.data.init.snapshot = true 
2025-05-19 13:34:09.981 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] common-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:34:09.990 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=common-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:34:09.990 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=common-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:34:09.990 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:34:09.990 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:34:09.990 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai.yaml, group=DEFAULT_GROUP
2025-05-19 13:34:09.992 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:34:09.992 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:34:09.992 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:34:09.992 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:34:09.992 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:34:09.992 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai, group=DEFAULT_GROUP
2025-05-19 13:34:18.333 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 接收到请求: /api/chatGatWay-internal, 文件=张陇阳的简历.pdf, 问题参数=null, 模型参数=null
2025-05-19 13:34:18.335 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 请求Content-Type: multipart/form-data;boundary=--------------------------355990493990566844824296
2025-05-19 13:34:18.335 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 收集到的完整参数: question="null", apiUrl="null", modelName="null", multiTurn=false
2025-05-19 13:34:18.337 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processing request for user ID: 689258T
2025-05-19 13:34:18.337 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processing file with circuit breaker: fileName=张陇阳的简历.pdf, question=
2025-05-19 13:34:18.339 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.config.ReactiveFileProcessor - Processing file: 张陇阳的简历.pdf, content-type: application/pdf
2025-05-19 13:34:18.346 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - PARAM TRACE [689258T]: 尝试查找匹配配置 - 参数: apiUrl=null, modelName=null
2025-05-19 13:34:18.356 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 查询配置 - userId=689258T
2025-05-19 13:34:18.358 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 排序方式 - 按ID降序
2025-05-19 13:34:18.358 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 限制结果数 - LIMIT 1
2025-05-19 13:34:18.424 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - ==>  Preparing: SELECT id,api_url,api_key,model_name,user_id FROM api_config WHERE (user_id = ?) ORDER BY id DESC LIMIT 1
2025-05-19 13:34:18.426 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - ==> Parameters: 689258T(String)
2025-05-19 13:34:18.440 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - <==      Total: 1
2025-05-19 13:34:18.440 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 查询结果 - 找到配置: id=2, modelName=deepseek-chat
2025-05-19 13:34:18.440 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - PARAM TRACE [689258T]: 找到匹配配置 - apiUrl=https://api.deepseek.com/chat/completions, modelName=deepseek-chat (原始请求: null)
2025-05-19 13:34:18.440 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - API config resolved: url=https://api.deepseek.com/chat/completions, model=deepseek-chat
2025-05-19 13:34:18.465 [Thread-47] INFO  com.bgpay.bgai.config.ReactiveFileProcessor - File processed successfully: size=146595 bytes
2025-05-19 13:34:18.807 [Thread-47] INFO  com.bgpay.bgai.controller.ReactiveChatController - Content processed, length: 6507
2025-05-19 13:34:18.814 [Thread-47] INFO  io.seata.tm.TransactionManagerHolder - TransactionManager Singleton io.seata.tm.DefaultTransactionManager@60611af1
2025-05-19 13:34:18.853 [Thread-47] INFO  io.seata.tm.api.DefaultGlobalTransaction - Begin new global transaction [seata-server:8091:27673667088527361]
2025-05-19 13:34:18.871 [Thread-47] INFO  c.b.bgai.service.impl.TransactionLogServiceImpl - 记录分布式事务开始: XID=seata-server:8091:27673667088527361, 业务=com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive
2025-05-19 13:34:18.878 [Thread-47] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - ==>  Preparing: INSERT INTO transaction_log ( xid, transaction_name, transaction_mode, status, request_path, source_ip, start_time, user_id, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:34:18.882 [Thread-47] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - ==> Parameters: seata-server:8091:27673667088527361(String), com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive(String), AT(String), ACTIVE(String), (String), (String), 2025-05-19T13:34:18.871718300(LocalDateTime), (String), 2025-05-19T13:34:18.871718300(LocalDateTime)
2025-05-19 13:34:19.327 [Thread-47] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - <==    Updates: 1
2025-05-19 13:34:19.368 [Thread-47] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527361, branchId:27673667088527362, lockKeys:transaction_log:1
2025-05-19 13:34:19.387 [Thread-47] WARN  i.s.c.l.EnhancedServiceLoader$InnerEnhancedServiceLoader - Load [io.seata.rm.datasource.undo.parser.ProtostuffUndoLogParser] class fail: io/protostuff/runtime/IdStrategy
2025-05-19 13:34:19.465 [Thread-47] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527361, branchId:27673667088527363, lockKeys:undo_log:1;transaction_log:1
2025-05-19 13:34:19.495 [Thread-47] INFO  c.b.bgai.interceptor.SeataTransactionInterceptor - 开始分布式事务: XID=seata-server:8091:27673667088527361, 方法=com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive
2025-05-19 13:34:19.506 [Thread-47] INFO  org.reflections.Reflections - Processing reactive request: content length=6507, apiUrl=https://api.deepseek.com/chat/completions, modelName=deepseek-chat, userId=689258T, multiTurn=false
2025-05-19 13:34:19.536 [Thread-47] INFO  com.bgpay.bgai.transaction.TransactionCoordinator - Transaction prepared for user 689258T: chatCompletionId=chat-dfb9ca2d-5910-4282-9554-29474caec418
2025-05-19 13:34:19.539 [Thread-47] INFO  org.reflections.Reflections - Generated request JSON with 2PC transaction: {"stream":false,"max_tokens":2000,"temperature":1.0,"messages":[{"role":"system","content":"You are ...
2025-05-19 13:34:19.575 [Thread-47] INFO  c.b.bgai.service.impl.TransactionLogServiceImpl - 记录分布式事务结束: XID=seata-server:8091:27673667088527361, 状态=COMMITTED
2025-05-19 13:34:19.577 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - ==>  Preparing: SELECT id,xid,branch_id,transaction_name,transaction_mode,status,request_path,source_ip,start_time,end_time,user_id,extra_data,create_time,update_time FROM transaction_log WHERE (xid = ?) LIMIT 1
2025-05-19 13:34:19.580 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - ==> Parameters: seata-server:8091:27673667088527361(String)
2025-05-19 13:34:19.589 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - <==      Total: 1
2025-05-19 13:34:19.597 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - ==>  Preparing: UPDATE transaction_log SET xid=?, transaction_name=?, transaction_mode=?, status=?, request_path=?, source_ip=?, start_time=?, end_time=?, user_id=?, extra_data=?, create_time=?, update_time=? WHERE id=?
2025-05-19 13:34:19.606 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - ==> Parameters: seata-server:8091:27673667088527361(String), com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive(String), AT(String), COMMITTED(String), (String), (String), 2025-05-19T13:34:19(LocalDateTime), 2025-05-19T13:34:19.589553200(LocalDateTime), (String), {"duration":73,"result":"success"}(String), 2025-05-19T13:34:19(LocalDateTime), 2025-05-19T13:34:19.589553200(LocalDateTime), 1(Long)
2025-05-19 13:34:19.660 [Thread-47] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - <==    Updates: 1
2025-05-19 13:34:19.670 [Thread-47] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527361, branchId:27673667088527364, lockKeys:transaction_log:1
2025-05-19 13:34:19.691 [Thread-47] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527361, branchId:27673667088527365, lockKeys:undo_log:3;transaction_log:1
2025-05-19 13:34:19.726 [Thread-47] INFO  c.b.bgai.interceptor.SeataTransactionInterceptor - 分布式事务成功完成: XID=seata-server:8091:27673667088527361, 耗时=73ms
2025-05-19 13:34:19.726 [Thread-47] INFO  io.seata.tm.api.DefaultGlobalTransaction - transaction seata-server:8091:27673667088527361 will be commit
2025-05-19 13:34:19.740 [Thread-47] INFO  io.seata.tm.api.DefaultGlobalTransaction - transaction end, xid = seata-server:8091:27673667088527361
2025-05-19 13:34:19.740 [Thread-47] INFO  io.seata.tm.api.DefaultGlobalTransaction - [seata-server:8091:27673667088527361] commit status: Committed
2025-05-19 13:34:20.663 [rpcDispatch_RMROLE_1_1_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527361', branchId=27673667088527362, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false,"skipCheckLock":true}'}
2025-05-19 13:34:20.666 [rpcDispatch_RMROLE_1_1_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527361 27673667088527362 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false,"skipCheckLock":true}
2025-05-19 13:34:20.672 [rpcDispatch_RMROLE_1_1_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:34:20.761 [rpcDispatch_RMROLE_1_2_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527361', branchId=27673667088527363, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false,"skipCheckLock":true}'}
2025-05-19 13:34:20.762 [rpcDispatch_RMROLE_1_2_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527361 27673667088527363 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false,"skipCheckLock":true}
2025-05-19 13:34:20.762 [rpcDispatch_RMROLE_1_2_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:34:20.773 [rpcDispatch_RMROLE_1_3_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527361', branchId=27673667088527364, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false}'}
2025-05-19 13:34:20.773 [rpcDispatch_RMROLE_1_3_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527361 27673667088527364 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false}
2025-05-19 13:34:20.773 [rpcDispatch_RMROLE_1_3_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:34:20.854 [rpcDispatch_RMROLE_1_4_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527361', branchId=27673667088527365, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false}'}
2025-05-19 13:34:20.854 [rpcDispatch_RMROLE_1_4_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527361 27673667088527365 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false}
2025-05-19 13:34:20.854 [rpcDispatch_RMROLE_1_4_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:35:05.457 [reactor-http-nio-3] INFO  org.reflections.Reflections - Raw response received, length: 2226
2025-05-19 13:35:05.465 [reactor-http-nio-3] WARN  org.reflections.Reflections - Received different chatCompletionId from response: 2bce6bb9-560a-4230-acc5-e8817b897461 vs prepared: chat-dfb9ca2d-5910-4282-9554-29474caec418
2025-05-19 13:35:05.479 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==>  Preparing: INSERT INTO chat_completions ( object, created, model, system_fingerprint, api_key ) VALUES ( ?, ?, ?, ?, ? )
2025-05-19 13:35:05.480 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==> Parameters: chat.completion(String), 1747632905478(Long), deepseek-chat(String), 689258T(String), chat-dfb9ca2d-5910-4282-9554-29474caec418(String)
2025-05-19 13:35:05.494 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - <==    Updates: 1
2025-05-19 13:35:05.495 [reactor-http-nio-3] INFO  com.bgpay.bgai.transaction.TransactionCoordinator - Transaction committed for user 689258T: chatCompletionId=chat-dfb9ca2d-5910-4282-9554-29474caec418
2025-05-19 13:35:05.513 [FileWrite-1] INFO  com.bgpay.bgai.service.deepseek.FileWriterService - Successfully wrote content to: \var\data\ai_responses\b724a2c8-3e35-4c89-a2e5-0458734df962.txt
2025-05-19 13:35:05.520 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==>  Preparing: INSERT INTO chat_completions ( object, created, model, system_fingerprint, api_key ) VALUES ( ?, ?, ?, ?, ? )
2025-05-19 13:35:05.520 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==> Parameters: chat.completion(String), 1747632860(Long), deepseek-chat(String), fp_8802369eaa_prod0425fp8(String), chat-dfb9ca2d-5910-4282-9554-29474caec418(String)
2025-05-19 13:35:05.530 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - <==    Updates: 1
2025-05-19 13:35:05.552 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - ==>  Preparing: INSERT INTO usage_info ( chat_completion_id, prompt_tokens, completion_tokens, total_tokens, prompt_tokens_cached, completion_reasoning_tokens, prompt_cache_hit_tokens, prompt_cache_miss_tokens, created_at, model_type ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:35:05.552 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - ==> Parameters: chat-dfb9ca2d-5910-4282-9554-29474caec418(String), 3796(Integer), 870(Integer), 4666(Integer), 3776(Integer), 0(Integer), 0(Integer), 20(Integer), 2025-05-19T13:35:05.543865900(LocalDateTime), deepseek-chat(String)
2025-05-19 13:35:05.569 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - <==    Updates: 1
2025-05-19 13:35:05.583 [boundedElastic-1] INFO  org.reflections.Reflections - Completion data saved synchronously for chatCompletionId: chat-dfb9ca2d-5910-4282-9554-29474caec418
2025-05-19 13:35:05.588 [boundedElastic-2] INFO  org.reflections.Reflections - 开始发送账单消息，chatCompletionId: chat-dfb9ca2d-5910-4282-9554-29474caec418, userId: 689258T
2025-05-19 13:35:05.658 [boundedElastic-2] INFO  org.reflections.Reflections - 账单消息发送成功，chatCompletionId: chat-dfb9ca2d-5910-4282-9554-29474caec418, userId: 689258T
2025-05-19 13:35:05.662 [boundedElastic-1] INFO  org.reflections.Reflections - Complete processing chain completed: 以下是张陇阳简历的优化建议及分点总结，旨在提升专业性、清晰度和竞争力：

---

### **一、格式与结构优化**
1. **统一排版**  
   - 中英文混排时增加空格（如"Personal resume"后）。  
   - 使用项目符号（•）替代“-”或“·”，保持列表一致性。  
   - 日期格式统一为“YYYY.MM - YYYY.MM”（如2023.04 - 2025.02）。  

2. **模块顺序调整**  
   建议按以下顺序排列：  
   - 基本信息 → 教育背景 → 工作经历（按时间倒序）→ 项目经验（合并到对应公司下）→ 技能特长 → 自我评价。  

3. **精简冗余内容**  
   - 删除重复描述（如“订单&支付系统”在工作经验和项目经验中重复出现）。  
   - 合并相似职责（如“自动化测试框架构建”可整合到技能特长中）。

---

### **二、内容强化建议**
#### **1. 工作经历**  
- **量化成果**  
  - 原句：*“重复扣款发生率降低”*  
    → 修改为：*“通过Redis分布式锁+RocketMQ消息去重，重复扣款率从2%降至0.1%”*  
  - 原句：*“支付接口响应时间缩短”*  
    → 修改为：*“优化数据库连接池与缓存策略，支付接口平均响应时间从1.2s缩短至0.5s”*  

- **技术关键词前置**  
  例：  
  > *“基于K8s+Docker构建弹性测试环境，部署效率提升50%”*  

#### **2. 项目经验**  
- **STAR法则优化**  
  - **Situation**：明确项目背景（如业务规模、痛点）。  
  - **Task**：突出个人角色（如“主导”“独立负责”）。  
  - **Action**：技术细节+工具链（如“使用Spark实时监控支付流水”）。  
  - **Result**：量化影响（如“退款成功率从85%提升至99%”）。  

#### **3. 技能特长**  
- **分层展示**：  
  ```markdown
  - **编程语言**: Java (Spring Boot), Python  
  - **中间件**: RocketMQ/Kafka, Redis, Elasticsearch  
  - **测试工具**: MeterSphere (二次开发), Selenium, Jira  
  - **云原生**: Docker/K8s, AWS EC2  
  ```  

---

### **三、语言表达优化**
1. **避免口语化**  
   - 原句：*“细心从每一个小细节开始”*  
     → 修改为：*“注重细节，追求系统稳定性与用户体验的极致优化”*  

2. **强化动作动词**  
   - 使用“构建”“设计”“优化”“主导”替代“负责”“参与”。  

3. **删除无效信息**  
   - 如“婚姻状况”“身高体重”等与岗位无关内容。

---

### **四、竞争力提升点**
1. **突出金融+新能源复合背景**  
   - 在摘要中强调：*“6年测试开发经验，覆盖金融支付、证券交易及新能源车联网系统，擅长高并发场景质量保障”*  

2. **补充证书/学习**（如有）  
   - 例如：*“ISTQB认证，持续学习云原生架构与性能测试”*  

3. **GitHub/技术博客**  
   - 若开源贡献或技术文章，可添加到联系方式中。

---

### **修改后简历优势**
- **更清晰的职业定位**：聚焦测试开发工程师角色，突出技术深度。  
- **数据驱动说服力**：量化成果提升HR和技术面试官的关注度。  
- **技术前瞻性**：云原生、实时计算等关键词贴合行业趋势。  

建议使用LaTeX或专业模板（如“超级简历”）进一步优化视觉呈现。
2025-05-19 13:35:05.663 [boundedElastic-1] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processed response for user 689258T, content length: 1688
2025-05-19 13:35:46.549 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - ==>  Preparing: SELECT COUNT( * ) AS total FROM usage_info WHERE (chat_completion_id = ?)
2025-05-19 13:35:46.550 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - ==> Parameters: chat-dfb9ca2d-5910-4282-9554-29474caec418(String)
2025-05-19 13:35:46.557 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - <==      Total: 1
2025-05-19 13:35:46.666 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - ==>  Preparing: SELECT id,model_type,time_period,cache_status,io_type,price,version,effective_time FROM price_config WHERE (model_type = ? AND time_period = ? AND io_type = ? AND effective_time <= ? AND cache_status = ?) ORDER BY effective_time DESC LIMIT 1
2025-05-19 13:35:46.666 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - ==> Parameters: deepseek-chat(String), standard(String), input(String), 2025-05-19T13:35:46.664620(LocalDateTime), miss(String)
2025-05-19 13:35:46.683 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - <==      Total: 1
2025-05-19 13:35:46.751 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - ==>  Preparing: SELECT id,model_type,time_period,cache_status,io_type,price,version,effective_time FROM price_config WHERE (model_type = ? AND time_period = ? AND io_type = ? AND effective_time <= ? AND cache_status IS NULL) ORDER BY effective_time DESC LIMIT 1
2025-05-19 13:35:46.752 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - ==> Parameters: deepseek-chat(String), standard(String), output(String), 2025-05-19T13:35:46.749991300(LocalDateTime)
2025-05-19 13:35:46.760 [ConsumeMessageThread_billing-consumer-group_1] DEBUG c.bgpay.bgai.mapper.PriceConfigMapper.selectList - <==      Total: 1
2025-05-19 13:35:46.826 [ConsumeMessageThread_billing-consumer-group_1] INFO  c.bgpay.bgai.service.mq.RocketMQBillingServiceImpl - Output price config priceVersion: 1
2025-05-19 13:35:46.829 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - ==>  Preparing: INSERT INTO usage_record ( model_type, chat_completion_id, user_id, input_cost, output_cost, price_version, calculated_at ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:35:46.829 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - ==> Parameters: deepseek-chat(String), chat-dfb9ca2d-5910-4282-9554-29474caec418(String), 689258T(String), 0.0000(BigDecimal), 0.0070(BigDecimal), 1(Integer), 2025-05-19T13:35:46.826510100(LocalDateTime)
2025-05-19 13:35:46.850 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - <==    Updates: 1
2025-05-19 13:35:46.859 [ConsumeMessageThread_billing-consumer-group_1] INFO  c.bgpay.bgai.service.mq.RocketMQBillingServiceImpl - Message consumed: 2408820C75288342B4869B724B724BF0861C36BAF30C5F9CB5940000
2025-05-19 13:39:09.939 [scheduling-1] WARN  com.alibaba.druid.pool.DruidAbstractDataSource - discard long time none received connection. , jdbcUrl : jdbc:mysql://8.133.246.113:3306/deepseek?autoReconnect=false&useUnicode=true&characterEncoding=UTF-8&characterSetResults=UTF-8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true&useSSL=false, version : 1.2.8, lastPacketReceivedIdleMillis : 203076
2025-05-19 13:39:10.945 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:39:10.945 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:39:10.956 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:39:10.956 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:39:10.956 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:39:10.964 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:42:01.018 [http-nio-8080-exec-6] ERROR o.s.b.a.w.r.error.AbstractErrorWebExceptionHandler - [430191f3]  500 Server Error for HTTP POST "/api/chatGatWay-internal"
org.springframework.data.redis.RedisSystemException: Redis exception
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:72)
	Suppressed: reactor.core.publisher.FluxOnAssembly$OnAssemblyException: 
Assembly trace from producer [reactor.core.publisher.MonoDefer] :
	reactor.core.publisher.Mono.defer(Mono.java:218)
	org.springframework.web.server.handler.DefaultWebFilterChain.filter(DefaultWebFilterChain.java:106)
Error has been observed at the following site(s):
	*______________Mono.defer ⇢ at org.springframework.web.server.handler.DefaultWebFilterChain.filter(DefaultWebFilterChain.java:106)
	|_             checkpoint ⇢ org.springframework.cloud.gateway.filter.WeightCalculatorWebFilter [DefaultWebFilterChain]
	*______________Mono.defer ⇢ at org.springframework.web.server.handler.DefaultWebFilterChain.filter(DefaultWebFilterChain.java:106)
	|_          Mono.doOnEach ⇢ at org.springframework.web.filter.reactive.ServerHttpObservationFilter.filter(ServerHttpObservationFilter.java:109)
	|_        Mono.doOnCancel ⇢ at org.springframework.web.filter.reactive.ServerHttpObservationFilter.filter(ServerHttpObservationFilter.java:119)
	|_      Mono.contextWrite ⇢ at org.springframework.web.filter.reactive.ServerHttpObservationFilter.filter(ServerHttpObservationFilter.java:123)
	*__Mono.transformDeferred ⇢ at org.springframework.web.filter.reactive.ServerHttpObservationFilter.filter(ServerHttpObservationFilter.java:102)
	|_             checkpoint ⇢ org.springframework.web.filter.reactive.ServerHttpObservationFilter [DefaultWebFilterChain]
	*______________Mono.defer ⇢ at org.springframework.web.server.handler.DefaultWebFilterChain.filter(DefaultWebFilterChain.java:106)
	|_     Mono.onErrorResume ⇢ at org.springframework.web.server.handler.ExceptionHandlingWebHandler.handle(ExceptionHandlingWebHandler.java:77)
	|_     Mono.onErrorResume ⇢ at org.springframework.web.server.handler.ExceptionHandlingWebHandler.handle(ExceptionHandlingWebHandler.java:77)
	*______________Mono.error ⇢ at org.springframework.web.server.handler.ExceptionHandlingWebHandler$CheckpointInsertingHandler.handle(ExceptionHandlingWebHandler.java:98)
	|_             checkpoint ⇢ HTTP POST "/api/chatGatWay-internal" [ExceptionHandlingWebHandler]
	*______________Mono.error ⇢ at org.springframework.cloud.gateway.filter.headers.observation.ObservationClosingWebExceptionHandler.handle(ObservationClosingWebExceptionHandler.java:53)
Original Stack Trace:
		at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:72)
		at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
		at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:40)
		at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:38)
		at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:256)
		at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:969)
		at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:826)
		at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:665)
		at org.springframework.data.redis.connection.lettuce.LettuceInvoker.just(LettuceInvoker.java:94)
		at org.springframework.data.redis.connection.lettuce.LettuceStringCommands.get(LettuceStringCommands.java:54)
		at org.springframework.data.redis.connection.DefaultedRedisConnection.get(DefaultedRedisConnection.java:284)
		at org.springframework.data.redis.core.DefaultValueOperations$1.inRedis(DefaultValueOperations.java:54)
		at org.springframework.data.redis.core.AbstractOperations$ValueDeserializingRedisCallback.doInRedis(AbstractOperations.java:61)
		at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:406)
		at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
		at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
		at org.springframework.data.redis.core.DefaultValueOperations.get(DefaultValueOperations.java:50)
		at com.bgpay.bgai.service.impl.UserServiceImpl.validateToken(UserServiceImpl.java:210)
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
		at java.base/java.lang.reflect.Method.invoke(Method.java:580)
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
		at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:751)
		at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
		at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:751)
		at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
		at com.bgpay.bgai.service.impl.UserServiceImpl$$SpringCGLIB$$0.validateToken(<generated>)
		at com.bgpay.bgai.config.AuthenticationFilter.filter(AuthenticationFilter.java:70)
		at org.springframework.web.server.handler.DefaultWebFilterChain.invokeFilter(DefaultWebFilterChain.java:114)
		at org.springframework.web.server.handler.DefaultWebFilterChain.lambda$filter$0(DefaultWebFilterChain.java:108)
		at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
		at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
		at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
		at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
		at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
		at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
		at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
		at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)
		at reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
		at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)
		at reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
		at org.springframework.http.server.reactive.ServletHttpHandlerAdapter.service(ServletHttpHandlerAdapter.java:199)
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
		at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: io.lettuce.core.RedisException: java.net.SocketException: Connection reset
	at io.lettuce.core.internal.Exceptions.bubble(Exceptions.java:83)
	at io.lettuce.core.internal.Futures.awaitOrCancel(Futures.java:250)
	at io.lettuce.core.LettuceFutures.awaitOrCancel(LettuceFutures.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:967)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:826)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:665)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker.just(LettuceInvoker.java:94)
	at org.springframework.data.redis.connection.lettuce.LettuceStringCommands.get(LettuceStringCommands.java:54)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.get(DefaultedRedisConnection.java:284)
	at org.springframework.data.redis.core.DefaultValueOperations$1.inRedis(DefaultValueOperations.java:54)
	at org.springframework.data.redis.core.AbstractOperations$ValueDeserializingRedisCallback.doInRedis(AbstractOperations.java:61)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:406)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultValueOperations.get(DefaultValueOperations.java:50)
	at com.bgpay.bgai.service.impl.UserServiceImpl.validateToken(UserServiceImpl.java:210)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:751)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:751)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at com.bgpay.bgai.service.impl.UserServiceImpl$$SpringCGLIB$$0.validateToken(<generated>)
	at com.bgpay.bgai.config.AuthenticationFilter.filter(AuthenticationFilter.java:70)
	at org.springframework.web.server.handler.DefaultWebFilterChain.invokeFilter(DefaultWebFilterChain.java:114)
	at org.springframework.web.server.handler.DefaultWebFilterChain.lambda$filter$0(DefaultWebFilterChain.java:108)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:53)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
	at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)
	at reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
	at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)
	at reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4495)
	at org.springframework.http.server.reactive.ServletHttpHandlerAdapter.service(ServletHttpHandlerAdapter.java:199)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:401)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:434)
	at io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:254)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:357)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-05-19 13:42:23.734 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-05-19 13:42:23.734 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-05-19 13:42:23.734 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-05-19 13:42:23.735 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:42:23.750 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0xfc74db87, L:/192.168.86.8:59406 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:42:23.751 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x4050435c, L:/192.168.86.8:59410 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:42:23.753 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-05-19 13:42:23.753 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - [DEREGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 deregistering service bgtech-ai with instance: Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
2025-05-19 13:42:23.759 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-05-19 13:42:23.760 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown begin
2025-05-19 13:42:23.760 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown stop
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown begin
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown begin
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown stop
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown begin
2025-05-19 13:42:23.761 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:42:23.761 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown stop
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown begin
2025-05-19 13:42:23.761 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:42:23.761 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown stop
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown rpc client, set status to shutdown
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown client event executor java.util.concurrent.ScheduledThreadPoolExecutor@682c81b3[Running, pool size = 2, active threads = 2, queued tasks = 0, completed tasks = 0]
2025-05-19 13:42:23.761 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Close current connection 1747632849737_139.227.195.203_43256
2025-05-19 13:42:23.764 [nacos-grpc-client-executor-8.133.246.113-110] WARN  c.a.nacos.common.remote.client.grpc.GrpcClient - [1747632849737_139.227.195.203_43256]Ignore error event,isRunning:false,isAbandon=false
2025-05-19 13:42:23.766 [SpringContextShutdownHook] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - Shutdown grpc executor java.util.concurrent.ThreadPoolExecutor@182a8bf8[Running, pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 111]
2025-05-19 13:42:23.766 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - Shutdown grpc redo service executor java.util.concurrent.ScheduledThreadPoolExecutor@5a19393[Running, pool size = 1, active threads = 0, queued tasks = 1, completed tasks = 164]
2025-05-19 13:42:23.766 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - [null] CredentialWatcher is stopped
2025-05-19 13:42:23.766 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialService - [null] CredentialService is freed
2025-05-19 13:42:23.766 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown stop
2025-05-19 13:42:24.348 [com.alibaba.nacos.client.Worker] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - null No credential found
2025-05-19 13:42:25.804 [SpringContextShutdownHook] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Shutting down ExecutorService 'blockingExecutor'
2025-05-19 13:42:25.838 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10909] result: true
2025-05-19 13:42:25.838 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:42:25.838 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:42:25.853 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:42:25.853 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:42:25.962 [SpringContextShutdownHook] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:42:25.963 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closing ...
2025-05-19 13:42:25.965 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closed
2025-05-19 13:42:25.965 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-05-19 13:42:25.966 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-05-19 13:42:32.648 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-05-19 13:42:32.649 [main] INFO  com.bgpay.bgai.BgaiApplication - The following 1 profile is active: "dev"
2025-05-19 13:42:33.968 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:42:33.970 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-19 13:42:33.993 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 JPA repository interfaces.
2025-05-19 13:42:34.004 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-19 13:42:34.005 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-19 13:42:34.016 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-05-19 13:42:34.594 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:42:34.603 [main] INFO  io.seata.config.ConfigurationFactory - load Configuration from :Spring Configuration
2025-05-19 13:42:34.609 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Initializing Global Transaction Clients ... 
2025-05-19 13:42:34.710 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:42:34.711 [main] INFO  io.seata.discovery.registry.RegistryFactory - use registry center type: file
2025-05-19 13:42:34.722 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:42:34.726 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:TMROLE,address:8.133.246.113:8091,msg:< RegisterTMRequest{version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='ak=null
digest=bgai-tx-group,192.168.86.8,1747633354724
timestamp=1747633354724
authVersion=V4
vgroup=bgai-tx-group
ip=192.168.86.8
'} >
2025-05-19 13:42:34.879 [main] INFO  io.seata.core.rpc.netty.TmNettyRemotingClient - register TM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0xaccabbe3, L:/192.168.86.8:57594 - R:/8.133.246.113:8091]
2025-05-19 13:42:34.889 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 78 ms, version:1.8.1-SNAPSHOT,role:TMROLE,channel:[id: 0xaccabbe3, L:/192.168.86.8:57594 - R:/8.133.246.113:8091]
2025-05-19 13:42:34.890 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:42:34.906 [main] INFO  io.seata.rm.datasource.AsyncWorker - Async Commit Buffer Limit: 10000
2025-05-19 13:42:34.907 [main] INFO  io.seata.rm.datasource.xa.ResourceManagerXA - ResourceManagerXA init ...
2025-05-19 13:42:34.914 [main] INFO  io.seata.core.rpc.netty.NettyClientBootstrap - NettyClientBootstrap has started
2025-05-19 13:42:34.914 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:42:34.914 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Global Transaction Clients are initialized. 
2025-05-19 13:42:36.043 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-19 13:42:36.055 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - The ["http-nio-8080"] connector has been configured to support HTTP upgrade to [h2c]
2025-05-19 13:42:36.055 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-19 13:42:36.057 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-05-19 13:42:36.057 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.15]
2025-05-19 13:42:36.451 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-05-19 13:42:36.708 [main] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - will connect to 8.133.246.113:8091
2025-05-19 13:42:36.708 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - RM will register :jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:42:36.708 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - NettyPool create channel to transactionRole:RMROLE,address:8.133.246.113:8091,msg:< RegisterRMRequest{resourceIds='jdbc:mysql://8.133.246.113:3306/deepseek', version='1.7.0', applicationId='bgtech-ai', transactionServiceGroup='bgai-tx-group', extraData='null'} >
2025-05-19 13:42:36.741 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - register RM success. client version:1.7.0, server version:1.8.1-SNAPSHOT,channel:[id: 0x0e68029e, L:/192.168.86.8:57615 - R:/8.133.246.113:8091]
2025-05-19 13:42:36.741 [main] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - register success, cost 11 ms, version:1.8.1-SNAPSHOT,role:RMROLE,channel:[id: 0x0e68029e, L:/192.168.86.8:57615 - R:/8.133.246.113:8091]
2025-05-19 13:42:36.743 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'masterDataSource' by 'AT' mode.
2025-05-19 13:42:36.814 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} inited
2025-05-19 13:42:36.882 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:42:36.884 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'slaveDataSource' by 'AT' mode.
2025-05-19 13:42:36.896 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:42:36.908 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:jdbc:mysql://8.133.246.113:3306/deepseek
2025-05-19 13:42:36.909 [main] INFO  i.s.s.a.datasource.SeataAutoDataSourceProxyCreator - Auto proxy data source 'dynamicDataSource' by 'AT' mode.
2025-05-19 13:42:36.920 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:42:37.040 [main] INFO  org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-05-19 13:42:37.089 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.1.7.Final
2025-05-19 13:42:37.402 [main] INFO  SQL dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL8Dialect
2025-05-19 13:42:37.404 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-05-19 13:42:37.678 [main] INFO  o.h.e.t.jta.platform.internal.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-05-19 13:42:37.689 [main] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:42:38.088 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:42:38.099 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:42:38.124 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:42:38.126 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:42:38.126 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:42:38.136 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:42:38.739 [main] INFO  com.bgpay.bgai.service.impl.UserServiceImpl - 初始化SSO配置: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:42:38.865 [main] INFO  com.bgpay.bgai.controller.AuthController - 初始化认证控制器: clientId=bgai-client-id, redirectUri=http://localhost:8080/api/auth/callback
2025-05-19 13:42:39.467 [main] INFO  o.a.r.s.autoconfigure.RocketMQAutoConfiguration - a producer (billing-producer-group) init on namesrv 8.133.246.113:9876
2025-05-19 13:42:39.728 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Bean [com.bgpay.bgai.service.deepseek.DeepSeekServiceImp$$SpringCGLIB$$0] with name [deepSeekServiceImp] would use interceptor [io.seata.spring.annotation.GlobalTransactionalInterceptor]
2025-05-19 13:42:39.987 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:42:39.987 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:42:40.006 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 加载到1个Saga状态机定义文件
2025-05-19 13:42:40.140 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 开始解析状态机定义: bgai-saga-transaction
2025-05-19 13:42:40.140 [main] INFO  com.bgpay.bgai.saga.CustomSagaJsonParser - 状态机定义解析成功: bgai-saga-transaction
2025-05-19 13:42:40.140 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 成功加载状态机定义: /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:42:40.642 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-05-19 13:42:40.770 [redisson-netty-4-6] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:42:41.107 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for 8.133.246.113/8.133.246.113:6379
2025-05-19 13:42:41.358 [main] INFO  com.bgpay.bgai.service.mq.MQConsumerService - MQ consumer startup successful [group=billing-consumer-group, topic=BILLING_TOPIC, tag=USER_BILLING]
2025-05-19 13:42:41.596 [main] INFO  i.seata.spring.annotation.GlobalTransactionScanner - Bean [com.bgpay.bgai.service.SeataTransactionService$$SpringCGLIB$$0] with name [seataTransactionService] would use interceptor [io.seata.spring.annotation.GlobalTransactionalInterceptor]
2025-05-19 13:42:41.721 [main] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Initializing ExecutorService 'blockingExecutor'
2025-05-19 13:42:43.057 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [After]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Before]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Between]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Cookie]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Header]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Host]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Method]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Path]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Query]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [ReadBody]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [RemoteAddr]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [XForwardedRemoteAddr]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [Weight]
2025-05-19 13:42:43.058 [main] INFO  o.s.c.gateway.route.RouteDefinitionRouteLocator - Loaded RoutePredicateFactory [CloudFoundryRouteService]
2025-05-19 13:42:44.388 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-05-19 13:42:44.732 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#accesskey'.
2025-05-19 13:42:44.733 [main] WARN  i.s.s.b.a.provider.SpringBootConfigurationProvider - The get method not found for the field 'SeataProperties#secretkey'.
2025-05-19 13:42:44.747 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Initializing Global Transaction Clients ... 
2025-05-19 13:42:44.747 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Transaction Manager Client is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:42:44.747 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Resource Manager is initialized. applicationId[bgtech-ai] txServiceGroup[bgai-tx-group]
2025-05-19 13:42:44.747 [main] INFO  io.seata.core.rpc.netty.RmNettyRemotingClient - will register resourceId:bgtech-ai#bgai-tx-group
2025-05-19 13:42:44.748 [main] INFO  io.seata.saga.tm.DefaultSagaTransactionalTemplate - Global Transaction Clients are initialized. 
2025-05-19 13:42:44.758 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.rm.AbstractRMHandler - the rm client received response msg [RegisterRMResponse{version='1.8.1-SNAPSHOT', extraData='null', identified=true, resultCode=null, msg='null'}] from tc server.
2025-05-19 13:42:46.025 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-19 13:42:46.039 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-19 13:42:46.050 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ans.namespace attribute : null
2025-05-19 13:42:46.050 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ALIBABA_ALIWARE_NAMESPACE attribute :null
2025-05-19 13:42:46.051 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from namespace attribute :null
2025-05-19 13:42:46.060 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-05-19 13:42:46.060 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-05-19 13:42:46.066 [main] INFO  com.alibaba.nacos.common.remote.client - [RpcClientFactory] create a new rpc client of 1f28af58-1bc8-4cc1-915c-daf56e47d9be
2025-05-19 13:42:46.068 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] RpcClient init, ServerListFactory = com.alibaba.nacos.client.naming.core.ServerListManager
2025-05-19 13:42:46.068 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Registry connection listener to current client:com.alibaba.nacos.client.naming.remote.gprc.redo.NamingGrpcRedoService
2025-05-19 13:42:46.068 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Register server push request handler:com.alibaba.nacos.client.naming.remote.gprc.NamingPushRequestHandler
2025-05-19 13:42:46.068 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Try to connect to server on start up, server: {serverIp = '8.133.246.113', server main port = 8848}
2025-05-19 13:42:46.069 [main] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - grpc client connection server:8.133.246.113 ip,serverPort:9848,grpcTslConfig:{"sslProvider":"OPENSSL","enableTls":false,"mutualAuthEnable":false,"trustAll":false}
2025-05-19 13:42:46.200 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Success to connect to server [8.133.246.113:8848] on start up, connectionId = 1747633366087_139.227.195.203_42199
2025-05-19 13:42:46.200 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$ConnectResetRequestHandler
2025-05-19 13:42:46.200 [main] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$$Lambda/0x000001ffa85255c8
2025-05-19 13:42:46.200 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.common.remote.client - [1f28af58-1bc8-4cc1-915c-daf56e47d9be] Notify connected event to listeners.
2025-05-19 13:42:46.200 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.client.naming - Grpc connection connect
2025-05-19 13:42:46.200 [main] INFO  com.alibaba.nacos.client.naming - [REGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 registering service bgtech-ai with instance Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={IPv6=[2408:820c:7528:8342:b486:9b72:4b72:4bf0], preserved.register.source=SPRING_CLOUD}}
2025-05-19 13:42:46.219 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP bgtech-ai 192.168.86.8:8080 register finished
2025-05-19 13:42:46.279 [main] INFO  com.bgpay.bgai.BgaiApplication - Started BgaiApplication in 15.652 seconds (process running for 17.196)
2025-05-19 13:42:46.283 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:42:46.283 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:42:46.297 [scheduling-1] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:42:46.297 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==>  Preparing: SELECT * FROM mime_type_config WHERE enabled = true
2025-05-19 13:42:46.298 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - ==> Parameters: 
2025-05-19 13:42:46.308 [main] DEBUG c.b.b.mapper.FileTypeMapper.selectActiveMimeTypes - <==      Total: 52
2025-05-19 13:42:46.309 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:42:46.309 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:42:46.317 [scheduling-1] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:42:46.317 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==>  Preparing: SELECT mime_type FROM allowed_file_type WHERE enabled = true
2025-05-19 13:42:46.317 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - ==> Parameters: 
2025-05-19 13:42:46.324 [main] DEBUG c.b.bgai.mapper.FileTypeMapper.selectAllowedTypes - <==      Total: 52
2025-05-19 13:42:46.324 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - ==================== Saga状态机加载报告 ====================
2025-05-19 13:42:46.324 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga状态机配置加载状态: 成功
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件数量: 1
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 已加载的状态机定义文件:
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig -  - /E:/project/bgai/target/classes/statelang/bgai-saga-transaction.json
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - Saga解析器状态: CUSTOM_FASTJSON2
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - 状态机解析结果: 成功 1 个, 失败 0 个
2025-05-19 13:42:46.325 [main] INFO  com.bgpay.bgai.config.SagaStateMachineConfig - =============================================================
2025-05-19 13:42:46.330 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - nacos.cache.data.init.snapshot = true 
2025-05-19 13:42:46.331 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] common-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:42:46.342 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=common-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:42:46.342 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=common-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:42:46.343 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:42:46.343 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:42:46.343 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai.yaml, group=DEFAULT_GROUP
2025-05-19 13:42:46.344 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai-dev.yaml+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:42:46.344 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:42:46.344 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai-dev.yaml, group=DEFAULT_GROUP
2025-05-19 13:42:46.344 [main] INFO  com.alibaba.nacos.client.config.impl.ClientWorker - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [subscribe] bgtech-ai+DEFAULT_GROUP+d750d92e-152f-4055-a641-3bc9dda85a29
2025-05-19 13:42:46.345 [main] INFO  com.alibaba.nacos.client.config.impl.CacheData - [fixed-d750d92e-152f-4055-a641-3bc9dda85a29-8.133.246.113_8848] [add-listener] ok, tenant=d750d92e-152f-4055-a641-3bc9dda85a29, dataId=bgtech-ai, group=DEFAULT_GROUP, cnt=1
2025-05-19 13:42:46.345 [main] INFO  c.a.cloud.nacos.refresh.NacosContextRefresher - [Nacos Config] Listening config: dataId=bgtech-ai, group=DEFAULT_GROUP
2025-05-19 13:42:58.102 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 接收到请求: /api/chatGatWay-internal, 文件=新文件 17.txt, 问题参数=null, 模型参数=null
2025-05-19 13:42:58.104 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 请求Content-Type: multipart/form-data;boundary=--------------------------482915283580857674954948
2025-05-19 13:42:58.104 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - 收集到的完整参数: question="null", apiUrl="null", modelName="null", multiTurn=false
2025-05-19 13:42:58.106 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processing request for user ID: 689258T
2025-05-19 13:42:58.106 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processing file with circuit breaker: fileName=新文件 17.txt, question=
2025-05-19 13:42:58.108 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.config.ReactiveFileProcessor - Processing file: 新文件 17.txt, content-type: text/plain
2025-05-19 13:42:58.116 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - PARAM TRACE [689258T]: 尝试查找匹配配置 - 参数: apiUrl=null, modelName=null
2025-05-19 13:42:58.126 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 查询配置 - userId=689258T
2025-05-19 13:42:58.127 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 排序方式 - 按ID降序
2025-05-19 13:42:58.127 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 限制结果数 - LIMIT 1
2025-05-19 13:42:58.194 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - ==>  Preparing: SELECT id,api_url,api_key,model_name,user_id FROM api_config WHERE (user_id = ?) ORDER BY id DESC LIMIT 1
2025-05-19 13:42:58.196 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - ==> Parameters: 689258T(String)
2025-05-19 13:42:58.204 [http-nio-8080-exec-2] DEBUG com.bgpay.bgai.mapper.ApiConfigMapper.selectList - <==      Total: 1
2025-05-19 13:42:58.204 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.service.impl.ApiConfigServiceImpl - 查询结果 - 找到配置: id=2, modelName=deepseek-chat
2025-05-19 13:42:58.204 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - PARAM TRACE [689258T]: 找到匹配配置 - apiUrl=https://api.deepseek.com/chat/completions, modelName=deepseek-chat (原始请求: null)
2025-05-19 13:42:58.204 [http-nio-8080-exec-2] INFO  com.bgpay.bgai.controller.ReactiveChatController - API config resolved: url=https://api.deepseek.com/chat/completions, model=deepseek-chat
2025-05-19 13:42:58.221 [Thread-50] INFO  com.bgpay.bgai.config.ReactiveFileProcessor - File processed successfully: size=6680 bytes
2025-05-19 13:42:58.226 [Thread-50] INFO  com.bgpay.bgai.controller.ReactiveChatController - Content processed, length: 6603
2025-05-19 13:42:58.232 [Thread-50] INFO  io.seata.tm.TransactionManagerHolder - TransactionManager Singleton io.seata.tm.DefaultTransactionManager@2356503e
2025-05-19 13:42:58.246 [Thread-50] INFO  io.seata.tm.api.DefaultGlobalTransaction - Begin new global transaction [seata-server:8091:27673667088527366]
2025-05-19 13:42:58.264 [Thread-50] INFO  c.b.bgai.service.impl.TransactionLogServiceImpl - 记录分布式事务开始: XID=seata-server:8091:27673667088527366, 业务=com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive
2025-05-19 13:42:58.272 [Thread-50] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - ==>  Preparing: INSERT INTO transaction_log ( xid, transaction_name, transaction_mode, status, request_path, source_ip, start_time, user_id, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:42:58.275 [Thread-50] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - ==> Parameters: seata-server:8091:27673667088527366(String), com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive(String), AT(String), ACTIVE(String), (String), (String), 2025-05-19T13:42:58.265169100(LocalDateTime), (String), 2025-05-19T13:42:58.265169100(LocalDateTime)
2025-05-19 13:42:58.650 [Thread-50] DEBUG com.bgpay.bgai.mapper.TransactionLogMapper.insert - <==    Updates: 1
2025-05-19 13:42:58.667 [Thread-50] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527366, branchId:27673667088527367, lockKeys:transaction_log:2
2025-05-19 13:42:58.676 [Thread-50] WARN  i.s.c.l.EnhancedServiceLoader$InnerEnhancedServiceLoader - Load [io.seata.rm.datasource.undo.parser.ProtostuffUndoLogParser] class fail: io/protostuff/runtime/IdStrategy
2025-05-19 13:42:58.758 [Thread-50] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527366, branchId:27673667088527368, lockKeys:undo_log:5;transaction_log:2
2025-05-19 13:42:58.792 [Thread-50] INFO  c.b.bgai.interceptor.SeataTransactionInterceptor - 开始分布式事务: XID=seata-server:8091:27673667088527366, 方法=com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive
2025-05-19 13:42:58.803 [Thread-50] INFO  org.reflections.Reflections - Processing reactive request: content length=6603, apiUrl=https://api.deepseek.com/chat/completions, modelName=deepseek-chat, userId=689258T, multiTurn=false
2025-05-19 13:42:58.826 [Thread-50] INFO  com.bgpay.bgai.transaction.TransactionCoordinator - Transaction prepared for user 689258T: chatCompletionId=chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500
2025-05-19 13:42:58.829 [Thread-50] INFO  org.reflections.Reflections - Generated request JSON with 2PC transaction: {"stream":false,"max_tokens":2000,"temperature":1.0,"messages":[{"role":"system","content":"You are ...
2025-05-19 13:42:58.854 [Thread-50] INFO  c.b.bgai.service.impl.TransactionLogServiceImpl - 记录分布式事务结束: XID=seata-server:8091:27673667088527366, 状态=COMMITTED
2025-05-19 13:42:58.856 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - ==>  Preparing: SELECT id,xid,branch_id,transaction_name,transaction_mode,status,request_path,source_ip,start_time,end_time,user_id,extra_data,create_time,update_time FROM transaction_log WHERE (xid = ?) LIMIT 1
2025-05-19 13:42:58.858 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - ==> Parameters: seata-server:8091:27673667088527366(String)
2025-05-19 13:42:58.866 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.selectList - <==      Total: 1
2025-05-19 13:42:58.870 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - ==>  Preparing: UPDATE transaction_log SET xid=?, transaction_name=?, transaction_mode=?, status=?, request_path=?, source_ip=?, start_time=?, end_time=?, user_id=?, extra_data=?, create_time=?, update_time=? WHERE id=?
2025-05-19 13:42:58.877 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - ==> Parameters: seata-server:8091:27673667088527366(String), com.bgpay.bgai.service.deepseek.DeepSeekServiceImp.processRequestReactive(String), AT(String), COMMITTED(String), (String), (String), 2025-05-19T13:42:58(LocalDateTime), 2025-05-19T13:42:58.867757900(LocalDateTime), (String), {"duration":56,"result":"success"}(String), 2025-05-19T13:42:58(LocalDateTime), 2025-05-19T13:42:58.867757900(LocalDateTime), 2(Long)
2025-05-19 13:42:58.924 [Thread-50] DEBUG c.b.bgai.mapper.TransactionLogMapper.updateById - <==    Updates: 1
2025-05-19 13:42:58.934 [Thread-50] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527366, branchId:27673667088527369, lockKeys:transaction_log:2
2025-05-19 13:42:58.963 [Thread-50] INFO  io.seata.rm.AbstractResourceManager - branch register success, xid:seata-server:8091:27673667088527366, branchId:27673667088527370, lockKeys:undo_log:7;transaction_log:2
2025-05-19 13:42:59.014 [Thread-50] INFO  c.b.bgai.interceptor.SeataTransactionInterceptor - 分布式事务成功完成: XID=seata-server:8091:27673667088527366, 耗时=56ms
2025-05-19 13:42:59.014 [Thread-50] INFO  io.seata.tm.api.DefaultGlobalTransaction - transaction seata-server:8091:27673667088527366 will be commit
2025-05-19 13:42:59.030 [Thread-50] INFO  io.seata.tm.api.DefaultGlobalTransaction - transaction end, xid = seata-server:8091:27673667088527366
2025-05-19 13:42:59.030 [Thread-50] INFO  io.seata.tm.api.DefaultGlobalTransaction - [seata-server:8091:27673667088527366] commit status: Committed
2025-05-19 13:42:59.629 [rpcDispatch_RMROLE_1_1_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527366', branchId=27673667088527367, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false,"skipCheckLock":true}'}
2025-05-19 13:42:59.632 [rpcDispatch_RMROLE_1_1_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527366 27673667088527367 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false,"skipCheckLock":true}
2025-05-19 13:42:59.634 [rpcDispatch_RMROLE_1_1_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:42:59.644 [rpcDispatch_RMROLE_1_2_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527366', branchId=27673667088527368, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false,"skipCheckLock":true}'}
2025-05-19 13:42:59.644 [rpcDispatch_RMROLE_1_2_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527366 27673667088527368 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false,"skipCheckLock":true}
2025-05-19 13:42:59.644 [rpcDispatch_RMROLE_1_2_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:42:59.653 [rpcDispatch_RMROLE_1_3_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527366', branchId=27673667088527369, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false}'}
2025-05-19 13:42:59.654 [rpcDispatch_RMROLE_1_3_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527366 27673667088527369 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false}
2025-05-19 13:42:59.654 [rpcDispatch_RMROLE_1_3_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:42:59.666 [rpcDispatch_RMROLE_1_4_24] INFO  i.s.c.rpc.processor.client.RmBranchCommitProcessor - rm client handle branch commit process:BranchCommitRequest{xid='seata-server:8091:27673667088527366', branchId=27673667088527370, branchType=AT, resourceId='jdbc:mysql://8.133.246.113:3306/deepseek', applicationData='{"autoCommit":false}'}
2025-05-19 13:42:59.667 [rpcDispatch_RMROLE_1_4_24] INFO  io.seata.rm.AbstractRMHandler - Branch committing: seata-server:8091:27673667088527366 27673667088527370 jdbc:mysql://8.133.246.113:3306/deepseek {"autoCommit":false}
2025-05-19 13:42:59.667 [rpcDispatch_RMROLE_1_4_24] INFO  io.seata.rm.AbstractRMHandler - Branch commit result: PhaseTwo_Committed
2025-05-19 13:43:43.487 [reactor-http-nio-3] INFO  org.reflections.Reflections - Raw response received, length: 2402
2025-05-19 13:43:43.492 [reactor-http-nio-3] WARN  org.reflections.Reflections - Received different chatCompletionId from response: 1d26d365-8c0d-49a0-81f5-d8f437d37011 vs prepared: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500
2025-05-19 13:43:43.506 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==>  Preparing: INSERT INTO chat_completions ( object, created, model, system_fingerprint, api_key ) VALUES ( ?, ?, ?, ?, ? )
2025-05-19 13:43:43.507 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==> Parameters: chat.completion(String), 1747633423505(Long), deepseek-chat(String), 689258T(String), chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500(String)
2025-05-19 13:43:43.519 [reactor-http-nio-3] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - <==    Updates: 1
2025-05-19 13:43:43.519 [reactor-http-nio-3] INFO  com.bgpay.bgai.transaction.TransactionCoordinator - Transaction committed for user 689258T: chatCompletionId=chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500
2025-05-19 13:43:43.539 [FileWrite-1] INFO  com.bgpay.bgai.service.deepseek.FileWriterService - Successfully wrote content to: \var\data\ai_responses\37d2cb5c-0b98-48e1-8e93-af37fac770bd.txt
2025-05-19 13:43:43.549 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==>  Preparing: INSERT INTO chat_completions ( object, created, model, system_fingerprint, api_key ) VALUES ( ?, ?, ?, ?, ? )
2025-05-19 13:43:43.550 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - ==> Parameters: chat.completion(String), 1747633379(Long), deepseek-chat(String), fp_8802369eaa_prod0425fp8(String), chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500(String)
2025-05-19 13:43:43.560 [boundedElastic-1] DEBUG c.bgpay.bgai.mapper.ChatCompletionsMapper.insert - <==    Updates: 1
2025-05-19 13:43:43.583 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - ==>  Preparing: INSERT INTO usage_info ( chat_completion_id, prompt_tokens, completion_tokens, total_tokens, prompt_tokens_cached, completion_reasoning_tokens, prompt_cache_hit_tokens, prompt_cache_miss_tokens, created_at, model_type ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:43:43.584 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - ==> Parameters: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500(String), 2209(Integer), 871(Integer), 3080(Integer), 0(Integer), 0(Integer), 0(Integer), 2209(Integer), 2025-05-19T13:43:43.576437800(LocalDateTime), deepseek-chat(String)
2025-05-19 13:43:43.597 [boundedElastic-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.insert - <==    Updates: 1
2025-05-19 13:43:43.618 [boundedElastic-1] INFO  org.reflections.Reflections - Completion data saved synchronously for chatCompletionId: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500
2025-05-19 13:43:43.622 [boundedElastic-2] INFO  org.reflections.Reflections - 开始发送账单消息，chatCompletionId: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500, userId: 689258T
2025-05-19 13:43:43.665 [boundedElastic-2] INFO  org.reflections.Reflections - 账单消息发送成功，chatCompletionId: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500, userId: 689258T
2025-05-19 13:43:43.667 [boundedElastic-1] INFO  org.reflections.Reflections - Complete processing chain completed: 这个配置文件看起来是一个Spring Boot应用的YAML配置文件，包含了许多重要的配置信息。以下是一些关键点的分析：

### 1. **基本配置**
- **应用名称**: `bgai`
- **激活的Profile**: `dev`
- **允许Bean定义覆盖**: `true`
- **会话存储**: 禁用 (`store-type: none`)

### 2. **数据库配置**
- **Redis**:
  - 主机: `8.133.246.113`
  - 端口: `6379`
  - 密码: `5z25u2sk`
  - 数据库: `0`
  
- **MySQL (动态数据源)**:
  - 主从配置 (`master` 和 `slave`)，使用相同的连接信息:
    - URL: `jdbc:mysql://8.133.246.113:3306/deepseek`
    - 用户名: `bgtech`
    - 密码: `Zly689258..`
    - 连接池使用Druid，配置了初始连接数、最小空闲连接、最大连接数等。

### 3. **JPA/Hibernate配置**
- 数据库平台: `MySQL8Dialect`
- DDL策略: `update`
- 显示SQL: `true`
- 关闭Open-in-View: `false`

### 4. **文件上传配置**
- 最大文件大小: `200MB`
- 最大请求大小: `200MB`

### 5. **任务执行配置**
- 线程池:
  - 核心大小: `50`
  - 最大大小: `200`
  - 队列容量: `1000`
  - 线程名前缀: `async-task-`

### 6. **RocketMQ配置**
- Name Server: `8.133.246.113:9876`
- 生产者和消费者组配置，以及超时和重试设置。

### 7. **Resilience4j配置**
- 熔断器 (`circuitbreaker`)、限时器 (`timelimiter`) 和重试 (`retry`) 的详细配置，用于处理服务调用的容错。

### 8. **其他配置**
- **Tesseract OCR**: 数据路径 `/usr/share/tesseract-ocr`
- **MyBatis-Plus**: 开启下划线转驼峰，日志实现为StdOutImpl。
- **Flink Job Manager**: 主机 `8.133.246.113`，端口 `8081`
- **文件输出路径**: `/var/data/ai_responses`
- **日志配置**: JSON格式，路径 `/var/data/ai_responses/application.log`

### 9. **安全配置**
- **SSO OAuth2**:
  - Client ID: `bgai-client-id`
  - Client Secret: `bgai-client-secret`
  - 各种URL配置（授权、令牌、用户信息、登出）
- **API密钥**:
  - 两个客户端密钥配置。

### 潜在的安全风险
1. **敏感信息暴露**:
   - Redis密码 (`5z25u2sk`) 和MySQL密码 (`Zly689258..`) 直接写在配置文件中，建议使用环境变量或配置中心加密存储。
   - RocketMQ、MySQL、Redis等服务的IP地址和端口暴露，如果是生产环境，建议使用内网地址或VPN。

2. **数据库连接**:
   - 主从配置使用了相同的连接信息，可能是笔误或配置错误，通常主从数据库应该有不同的连接信息。

3. **SSL配置**:
   - MySQL连接URL中 `useSSL=false`，建议在生产环境中启用SSL加密连接。

### 建议
1. **使用配置加密**:
   - 使用Spring Cloud Config或Vault等工具加密敏感信息。
   
2. **环境隔离**:
   - 将开发、测试、生产环境的配置分开，避免敏感信息泄露。

3. **日志安全**:
   - 确保日志文件不会记录敏感信息（如密码、密钥等）。

如果需要进一步优化或调整某些配置，可以提供更具体的需求或问题。
2025-05-19 13:43:43.667 [boundedElastic-1] INFO  com.bgpay.bgai.controller.ReactiveChatController - Processed response for user 689258T, content length: 1868
2025-05-19 13:44:16.567 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - ==>  Preparing: SELECT COUNT( * ) AS total FROM usage_info WHERE (chat_completion_id = ?)
2025-05-19 13:44:16.567 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - ==> Parameters: chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500(String)
2025-05-19 13:44:16.572 [pool-7-thread-1] DEBUG com.bgpay.bgai.mapper.UsageInfoMapper.selectCount - <==      Total: 1
2025-05-19 13:44:16.744 [ConsumeMessageThread_billing-consumer-group_1] INFO  c.bgpay.bgai.service.mq.RocketMQBillingServiceImpl - Output price config priceVersion: 1
2025-05-19 13:44:16.756 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - ==>  Preparing: INSERT INTO usage_record ( model_type, chat_completion_id, user_id, input_cost, output_cost, price_version, calculated_at ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2025-05-19 13:44:16.757 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - ==> Parameters: deepseek-chat(String), chat-acd973c0-9b9f-4b46-88fb-fbc8dea4e500(String), 689258T(String), 0.0044(BigDecimal), 0.0070(BigDecimal), 1(Integer), 2025-05-19T13:44:16.744294300(LocalDateTime)
2025-05-19 13:44:16.783 [ConsumeMessageThread_billing-consumer-group_1] DEBUG com.bgpay.bgai.mapper.UsageRecordMapper.insert - <==    Updates: 1
2025-05-19 13:44:16.796 [ConsumeMessageThread_billing-consumer-group_1] INFO  c.bgpay.bgai.service.mq.RocketMQBillingServiceImpl - Message consumed: 2408820C75288342B4869B724B724BF0740436BAF30C5FA49D210000
2025-05-19 13:44:53.790 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-05-19 13:44:53.790 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-05-19 13:44:53.790 [Thread-7] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-05-19 13:44:53.790 [Thread-1] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-05-19 13:44:53.806 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.806 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.807 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.807 [NettyClientSelector_TMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.807 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:44:53.807 [NettyClientSelector_TMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0xaccabbe3, L:/192.168.86.8:57594 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:44:53.807 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - channel inactive: [id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.807 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyClientChannelManager - return to pool, rm channel:[id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.808 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - channel valid false,channel:[id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.808 [NettyClientSelector_RMROLE_1_1] INFO  io.seata.core.rpc.netty.NettyPoolableFactory - will destroy channel:[id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]
2025-05-19 13:44:53.808 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:44:53.808 [NettyClientSelector_RMROLE_1_1] INFO  i.seata.core.rpc.netty.AbstractNettyRemotingClient - ChannelHandlerContext(AbstractNettyRemotingClient$ClientHandler#0, [id: 0x0e68029e, L:/192.168.86.8:57615 ! R:/8.133.246.113:8091]) will closed
2025-05-19 13:44:53.809 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-05-19 13:44:53.810 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - [DEREGISTER-SERVICE] d750d92e-152f-4055-a641-3bc9dda85a29 deregistering service bgtech-ai with instance: Instance{instanceId='null', ip='192.168.86.8', port=8080, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
2025-05-19 13:44:53.819 [SpringContextShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown begin
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown stop
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown begin
2025-05-19 13:44:53.820 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown begin
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown stop
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown begin
2025-05-19 13:44:53.821 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:44:53.821 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown stop
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown begin
2025-05-19 13:44:53.821 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-05-19 13:44:53.821 [SpringContextShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown stop
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown rpc client, set status to shutdown
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown client event executor java.util.concurrent.ScheduledThreadPoolExecutor@3a4a86a9[Running, pool size = 2, active threads = 2, queued tasks = 0, completed tasks = 0]
2025-05-19 13:44:53.821 [SpringContextShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Close current connection 1747633366087_139.227.195.203_42199
2025-05-19 13:44:53.824 [nacos-grpc-client-executor-8.133.246.113-37] WARN  c.a.nacos.common.remote.client.grpc.GrpcClient - [1747633366087_139.227.195.203_42199]Ignore error event,isRunning:false,isAbandon=false
2025-05-19 13:44:53.826 [SpringContextShutdownHook] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - Shutdown grpc executor java.util.concurrent.ThreadPoolExecutor@68af530a[Running, pool size = 5, active threads = 0, queued tasks = 0, completed tasks = 38]
2025-05-19 13:44:53.826 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - Shutdown grpc redo service executor java.util.concurrent.ScheduledThreadPoolExecutor@41c9d35f[Running, pool size = 1, active threads = 0, queued tasks = 1, completed tasks = 42]
2025-05-19 13:44:53.826 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - [null] CredentialWatcher is stopped
2025-05-19 13:44:53.826 [SpringContextShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialService - [null] CredentialService is freed
2025-05-19 13:44:53.826 [SpringContextShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown stop
2025-05-19 13:44:55.856 [SpringContextShutdownHook] DEBUG com.bgpay.bgai.config.AsyncConfig$1 - Shutting down ExecutorService 'blockingExecutor'
2025-05-19 13:44:55.890 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10909] result: true
2025-05-19 13:44:55.890 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:44:55.890 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:44:55.903 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:10911] result: true
2025-05-19 13:44:55.903 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[8.133.246.113:9876] result: true
2025-05-19 13:44:56.018 [SpringContextShutdownHook] INFO  o.s.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-05-19 13:44:56.019 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closing ...
2025-05-19 13:44:56.025 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-2} closed
2025-05-19 13:44:56.025 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-05-19 13:44:56.025 [SpringContextShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
